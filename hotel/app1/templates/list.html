{% extends "base.html" %}
{% block content %}
<div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
        <span>Checklists</span>
        <div class="position-fixed top-0 end-0 p-3" style="z-index: 1100">
  {% for message in messages %}
  <div class="toast text-bg-primary border-0 shadow-lg mb-3" role="alert" aria-live="assertive" aria-atomic="true" style="min-width: 350px; font-size: 1.1rem;">
    <div class="d-flex">
      <div class="toast-body fw-bold">
        {{ message }}
      </div>
      <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
    </div>
  </div>
  {% endfor %}
</div>
        <a href="{% url 'add_checklist' %}" class="btn btn-sm btn-dark">+ Add Checklist</a>
    </div>
    <div class="card-body">
        <table class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>Checklist Name</th>
                    <th>Linked Location</th>
                    <th>Items</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for checklist in checklists %}
                <tr>
                    <td>{{ checklist.name }}</td>
                    <td>
                        {% if checklist.location %}
                            {{ checklist.location.name }}
                        {% else %}
                            Not assigned
                        {% endif %}
                    </td>
                    <td>
                        <ul>
                            {% for item in checklist.checklistitem_set.all %}
                                <li>
                                    {{ item.label }} {% if item.required %}(Required){% endif %}
                                    <a href="{% url 'edit_item' item.item_id %}" class="ms-2">✏️</a>
                                    <a href="{% url 'delete_item' item.item_id %}" class="ms-1" onclick="return confirm('Delete item?')">🗑️</a>
                                </li>
                            {% empty %}
                                <li>No items</li>
                            {% endfor %}
                        </ul>
                        <a href="{% url 'add_item' checklist.checklist_id %}" class="btn btn-sm btn-secondary mt-1">+ Add Item</a>
                    </td>
                    <td>
                        <a href="{% url 'edit_checklist' checklist.checklist_id %}" class="btn btn-sm btn-warning">✏️</a>
                        <a href="{% url 'delete_checklist' checklist.checklist_id %}" class="btn btn-sm btn-danger" onclick="return confirm('Delete checklist?')">🗑️</a>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="4" class="text-center">No checklists available</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
