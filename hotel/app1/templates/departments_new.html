{% extends "base_new.html" %}
{% block content %}

<div class="w-[1134px] h-16 px-6 py-4 bg-black/0 border-b border-gray-200 inline-flex justify-between items-center">
<div class="w-36 h-7 relative bg-black/0 border-gray-200">
<div class="w-36 h-7 left-0 top-[3px] absolute justify-start text-gray-900 text-lg font-semibold font-['Inter']">All Departments</div>
</div>
<div class="w-52 h-9 bg-black/0 border-gray-200 flex justify-start items-center gap-3">
 <div class="w-44 h-10 px-4 py-2 bg-sky-600 rounded-lg border-gray-200 inline-flex justify-start items-center gap-2">
    <div class="w-3.5 h-6 relative bg-black/0 border-gray-200">
        <div class="w-3.5 h-4 left-0 top-[4px] absolute inline-flex justify-center items-center">
            <div class="fixed top-0 right-0 p-3 z-[1100]">
            {% include "pop-up.html" %}
            <!-- Add Department button -->
            <button 
                class="px-2 py-1 bg-gray-800 text-white text-sm rounded hover:bg-gray-700"
                onclick="document.getElementById('addDeptModal').classList.remove('hidden')">
                +
            </button>
        </div>
    </div>
    <div class="w-32 h-6 relative bg-black/0 border-gray-200">
        <div class="w-32 h-6 left-0 top-[2px] absolute text-center justify-start text-white text-base font-normal font-['Inter']" data-bs-toggle="modal" data-bs-target="#addDeptModal">Add Department</div>
    </div>
</div>
</div></div>
   <div class="w-[1151.92px] h-14 relative bg-black/0 border-gray-200">
<div class="w-72 h-14 left-0 top-0 absolute bg-black/0 border-gray-200">
<div class="w-11 h-4 left-[24px] top-[20px] absolute justify-start text-neutral-500 text-xs font-medium font-['Inter'] tracking-wide">Depaertment</div>
</div>
<div class="w-56 h-14 left-[303.72px] top-0 absolute bg-black/0 border-gray-200">
<div class="w-32 h-4 left-[24px] top-[20px] absolute justify-start text-neutral-500 text-xs font-medium font-['Inter'] tracking-wide">Description</div>
</div>
<div class="w-32 h-14 left-[522.27px] top-0 absolute bg-black/0 border-gray-200">
<div class="w-12 h-4 left-[24px] top-[20px] absolute justify-start text-neutral-500 text-xs font-medium font-['Inter'] tracking-wide">Total Users</div>
</div>
<div class="w-28 h-14 left-[645.31px] top-0 absolute bg-black/0 border-gray-200">
<div class="w-16 h-4 left-[24px] top-[20px] absolute text-right justify-start text-neutral-500 text-xs font-medium font-['Inter'] tracking-wide">Actions</div>
</div>
</div>
         <div class="w-[1151.92px] h-auto bg-white border border-gray-200 relative">

    {% for dept in departments %}
    <!-- Row Container -->
    <div class="w-72 h-20 relative bg-black/0 border-gray-200">
<div class="w-64 h-10 left-[24px] top-[16px] absolute bg-black/0 border-gray-200 inline-flex justify-start items-center gap-4">
<div class="w-10 h-10 relative bg-black/0 border-gray-200">
<div class="w-10 h-10 left-0 top-0 absolute bg-teal-500/10 rounded-lg border-gray-200 inline-flex justify-center items-center">
<div class="w-4 h-6 relative bg-black/0 border-gray-200">
<div class="w-4 h-4 left-0 top-[4px] absolute inline-flex justify-center items-center">
<div class="w-4 h-4 relative bg-black/0 border-gray-200 overflow-hidden">
<div class="w-4 h-4 left-0 top-0 absolute bg-teal-500"></div>
</div>
</div>
</div>
</div>
</div>
<div class="w-48 h-10 relative bg-black/0 border-gray-200">
<div class="w-48 h-5  absolute bg-black/0 border-gray-200">
<div class="w-24 h-5  absolute justify-start text-gray-900 text-sm font-medium font-['Inter']">{{dept.name}}</div>
</div></div></div>

        <!-- Department Head -->
        <div class="w-56 h-20 absolute left-[303.72px] top-0 flex items-center gap-3 px-6">
           
            <div class="flex flex-col justify-center">
                <span class="text-gray-900 text-sm font-medium font-['Inter']">{{ dept.description }}</span>
                
            </div>
        </div>

        <!-- Total Users -->
        <div class="w-32 h-20 absolute left-[522.27px] top-0 flex flex-col justify-center px-6">
            <span class="text-gray-900 text-sm font-medium font-['Inter']">{{ dept.total_users }}</span>
            <span class="text-neutral-500 text-sm font-normal font-['Inter']">Active staff</span>
        </div>


        <!-- Actions -->
        <div class="w-28 h-20 absolute left-[645.31px] top-0 flex items-center gap-2 px-6">
            <!-- Edit Button -->
                  <button 
                            class="px-2 py-1 bg-yellow-400 text-white rounded text-sm hover:bg-yellow-500"
                            onclick="document.getElementById('editDeptModal{{ dept.department_id }}').classList.remove('hidden')">
                            ‚úèÔ∏è
                        </button>

            <!-- Delete Button -->
            <a href="{% url 'delete_department' dept.department_id %}"
               onclick="return confirm('Are you sure you want to delete this department?')"
               class="bg-red-400/10 text-red-500 px-2 py-1 rounded hover:bg-red-400/20">
               üóëÔ∏è
            </a>
        </div>

  

</div>


                <!-- Edit Modal -->
                <div id="editDeptModal{{ dept.department_id }}" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
                  <div class="bg-white rounded-lg shadow-lg w-full max-w-md">
                    <form method="POST" action="{% url 'edit_department' dept.department_id %}">
                        {% csrf_token %}
                        <div class="border-b px-4 py-2 flex justify-between items-center">
                            <h5 class="text-lg font-semibold">Edit Department</h5>
                            <button type="button" class="text-gray-500 hover:text-gray-700" 
                                    onclick="document.getElementById('editDeptModal{{ dept.department_id }}').classList.add('hidden')">
                                ‚úñ
                            </button>
                        </div>
                        <div class="p-4">
                            <div class="mb-2">
                                <label for="deptName{{ dept.department_id }}" class="block text-sm font-medium">Name</label>
                                <input type="text" id="deptName{{ dept.department_id }}" name="name" 
                                       value="{{ dept.name }}" required
                                       class="w-full px-3 py-2 border rounded focus:outline-none focus:ring focus:ring-purple-300">
                            </div>
                            <div class="mb-2">
                                <label for="deptDesc{{ dept.department_id }}" class="block text-sm font-medium">Description</label>
                                <textarea id="deptDesc{{ dept.department_id }}" name="description"
                                          class="w-full px-3 py-2 border rounded focus:outline-none focus:ring focus:ring-purple-300">{{ dept.description }}</textarea>
                            </div>
                        </div>
                        <div class="flex justify-end border-t px-4 py-2">
                            <button type="submit" class="px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700">Update</button>
                        </div>
                    </form>
                  </div>
                </div>
                {% endfor %}
            
        
    </div>
</div>

<!-- Add Department Modal -->
<div id="addDeptModal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
  <div class="bg-white rounded-lg shadow-lg w-full max-w-md">
    <form method="POST" action="{% url 'add_department' %}">
        {% csrf_token %}
        <div class="border-b px-4 py-2 flex justify-between items-center">
            <h5 class="text-lg font-semibold">Add Department</h5>
            <button type="button" class="text-gray-500 hover:text-gray-700" 
                    onclick="document.getElementById('addDeptModal').classList.add('hidden')">
                ‚úñ
            </button>
        </div>
        <div class="p-4">
            <div class="mb-2">
                <input type="text" name="name" placeholder="Enter department name" required
                       class="w-full px-3 py-2 border rounded focus:outline-none focus:ring focus:ring-purple-300">
            </div>
            <div class="mb-2">
                <textarea name="description" placeholder="Enter description"
                          class="w-full px-3 py-2 border rounded focus:outline-none focus:ring focus:ring-purple-300"></textarea>
            </div>
        </div>
        <div class="flex justify-end border-t px-4 py-2">
            <button type="submit" class="px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700">Save</button>
        </div>
    </form>
  </div>
</div>
</div>
{% endblock %}