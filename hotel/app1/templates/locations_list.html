{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
    <h2 class="mb-4">Locations</h2>
    <div class="container mt-4">
    <h2 class="mb-4">Locations</h2>
    <div class="position-fixed top-0 end-0 p-3" style="z-index: 1100">
  {% include "pop-up.html" %}
    <!-- Filters -->
    <form method="get" class="row g-3 mb-4 align-items-end">
        <div class="col-md-2">
            <label for="family" class="form-label">Family</label>
            <select class="form-select" id="family" name="family">
                <option value="">All</option>
                {% for f in families %}
                    <option value="{{ f.family_id }}" {% if selected_family == f.family_id|stringformat:"s" %}selected{% endif %}>{{ f.name }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="col-md-2">
            <label for="type" class="form-label">Type</label>
            <select class="form-select" id="type" name="type">
                <option value="">All</option>
                {% for t in types %}
                    <option value="{{ t.type_id }}" {% if selected_type == t.type_id|stringformat:"s" %}selected{% endif %}>{{ t.name }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="col-md-2">
            <label for="floor" class="form-label">Floor</label>
            <select class="form-select" id="floor" name="floor">
                <option value="">All</option>
                {% for f in floors %}
                    <option value="{{ f.floor_id }}" {% if selected_floor == f.floor_id|stringformat:"s" %}selected{% endif %}>{{ f.floor_number }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="col-md-2">
            <label for="building" class="form-label">Building</label>
            <select class="form-select" id="building" name="building">
                <option value="">All</option>
                {% for b in buildings %}
                    <option value="{{ b.building_id }}" {% if selected_building == b.building_id|stringformat:"s" %}selected{% endif %}>{{ b.name }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="col-md-4 d-flex gap-2">
            <button type="submit" class="btn btn-primary">Filter</button>
            <a href="{% url 'location_add' %}" class="btn btn-success">Add New Location</a>
        </div>
    </form>

    <!-- Locations Table -->
    <div class="table-responsive">
        <table class="table table-bordered table-hover">
            <thead class="table-light">
                <tr>
                    <th>Room No</th>
                    <th>Name</th>
                    <th>Family</th>
                    <th>Type</th>
                    <th>Floor</th>
                    <th>Building</th>
                    <th>Pavilion</th>
                    <th>Capacity</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for loc in locations %}
                <tr>
                    <td>{{ loc.room_no }}</td>
                    <td>{{ loc.name }}</td>

                    <td>
                        {% if loc.family %}
                            {{ loc.family.name }}
                        {% else %}
                            -
                        {% endif %}
                    </td>

                    <td>
                        {% if loc.type %}
                            {{ loc.type.name }}
                        {% else %}
                            -
                        {% endif %}
                    </td>

                    <td>
                        {% if loc.floor %}
                            {{ loc.floor.floor_number }}
                        {% else %}
                            -
                        {% endif %}
                    </td>

                    <td>
                        {% if loc.building %}
                            {{ loc.building.name }}
                        {% else %}
                            -
                        {% endif %}
                    </td>

                    <td>{{ loc.pavilion }}</td>
                    <td>{{ loc.capacity }}</td>
                    <td>
                        <a href="{% url 'location_edit' loc.location_id %}" class="btn btn-sm btn-warning">Edit</a>
                        <a href="{% url 'location_delete' loc.location_id %}" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure?')">Delete</a>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="9" class="text-center">No locations found.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

    <!-- Families Table -->
    <h5>Families</h5>
     <div class="mb-3">
        <a href="{% url 'family_add' %}" class="btn btn-success me-2 text-end">Add Family</a>
    <table class="table table-bordered table-striped">
        <thead>
            <tr>
                <th>ID</th>
                <th>Family Name</th>
                <th class="text-end">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for f in families %}
            <tr>
                <td>{{ f.family_id }}</td>
                <td>{{ f.name }}</td>
                <td class="text-end">
                    <a href="{% url 'family_edit' f.family_id %}" class="btn btn-sm btn-primary">Edit</a>
                    <a href="{% url 'family_delete' f.family_id %}" class="btn btn-sm btn-danger"
                       onclick="return confirm('Are you sure you want to delete this family?')">Delete</a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="3" class="text-center">No families found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table></div>

    <!-- Types Table -->
    <h5>Types</h5>
    <div class="mb-3">
        
        <a href="{% url 'type_add' %}" class="btn btn-success me-2 text-end">Add Type</a>
    <table class="table table-bordered table-striped">
        <thead>
            <tr>
                <th>ID</th>
                <th>Type Name</th>
                <th class="text-end">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for t in types %}
            <tr>
                <td>{{ t.type_id }}</td>
                <td>{{ t.name }}</td>
                <td class="text-end">
                    <a href="{% url 'type_edit' t.type_id %}" class="btn btn-sm btn-primary">Edit</a>
                    <a href="{% url 'type_delete' t.type_id %}" class="btn btn-sm btn-danger"
                       onclick="return confirm('Are you sure you want to delete this type?')">Delete</a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="3" class="text-center">No types found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table></div>

    <!-- Floors Table -->
    <h5>Floors</h5>
    <div class="mb-3">
        
        
        <a href="{% url 'floor_add' %}" class="btn btn-success me-2 text-end">Add Floor</a>
    <table class="table table-bordered table-striped">
        <thead>
            <tr>
                <th>ID</th>
                <th>Floor Name</th>
                <th>Floor Number</th>
                <th class="text-end">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for fl in floors %}
            <tr>
                <td>{{ fl.floor_id }}</td>
                <td>{{ fl.floor_name }}</td>
                <td>{{ fl.floor_number }}</td>
                <td class="text-end">
                    <a href="{% url 'floor_edit' fl.floor_id %}" class="btn btn-sm btn-primary">Edit</a>
                    
                    <a href="{% url 'floor_delete' fl.floor_id %}" class="btn btn-sm btn-danger"
                       onclick="return confirm('Are you sure you want to delete this floor?')">Delete</a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4" class="text-center">No floors found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Buildings Table -->
    <h5>Buildings</h5>
    <div class="mb-3">
        
        <a href="{% url 'building_add' %}" class="btn btn-success">Add Building</a>
    <table class="table table-bordered table-striped">
        <thead>
            <tr>
                <th>ID</th>
                <th>Building Name</th>
                <th class="text-end">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for b in buildings %}
            <tr>
                <td>{{ b.building_id }}</td>
                <td>{{ b.name }}</td>
                <td class="text-end">
                    <a href="{% url 'building_edit' b.building_id %}" class="btn btn-sm btn-primary">Edit</a>
                    <a href="{% url 'building_delete' b.building_id %}" class="btn btn-sm btn-danger"
                       onclick="return confirm('Are you sure you want to delete this building?')">Delete</a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="3" class="text-center">No buildings found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table></div>
</div>
{% endblock %}

